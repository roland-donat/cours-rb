<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<title>Introduction aux Réseaux Bayésiens  <br> <br> <br> <font size="10">Apprentissage automatique des lois de probabilité conditionnelles</font></title>
<meta name="author" content="Roland Donat"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/theme/white.css" id="theme"/>

<link rel="stylesheet" href="https://roland-donat.github.io/ubs/Charte_graphique/IUT/ubs_iut_vannes_reveal.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
TeX: {
Macros: {
pa: ["\\text{pa}"],
Pa: ["\\text{Pa}"],
lrpar: ["\\left( #1 \\right)", 1],
lrPar: ["\\left( #1 \\right)", 1],
lrbrack: ["[ #1 ]", 1],
lrBrack: ["\\left[ #1 \\right]", 1],
set: ["\\left\\lbrace #1 \\right\\rbrace", 1],
Prob: ["P"],
inter: ["\\cap"],
union: ["\\cup"],
Dom: ["\\text{Dom}"],
mbf: ["\\boldsymbol{#1}", 1],
argmin: ["\\underset{#1}{\arg\min}~", 1],
argmax: ["\\underset{#1}{\arg\max}~", 1],
mathbfcal: ["\\boldsymbol{\\mathcal{#1}}", 1],
sm: ["\\setminus"],
}
}
});
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-background="https://roland-donat.github.io/ubs/Charte_graphique/IUT/ubs_iut_vannes_couv.jpg"><h1 class="title">Introduction aux Réseaux Bayésiens  <br> <br> <br> <font size="10">Apprentissage automatique des lois de probabilité conditionnelles</font></h1><p class="subtitle"></p>
<h2 class="author">Roland Donat</h2><h2 class="date"> <br>BUT3 : Science des Données</h2>
</section>
<section id="sec-table-of-contents"><div id="table-of-contents" role="doc-toc">
<h2>Table des matières</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#/slide-orgf25bd00">Objectifs de la séance</a></li>
<li><a href="#/slide-org51953cf">Introduction</a></li>
<li><a href="#/slide-org4365343">Apprentissage des LPC</a></li>
</ul>
</div>
</div>
</section>


<section>
<section id="slide-orgf25bd00">
<h2 id="orgf25bd00">Objectifs de la séance</h2>
<div class="column" style="float:left; width: 50%">

<ul>
<li>Comprendre les problématiques liées à la construction pratique d'un réseau bayésien</li>
<li>Estimer automatiquement les lois de probabilité conditionnelles (LPC) à partir de données
observées sur le phénomène étudié</li>

</ul>

</div>

<div class="column" style="float:right; width: 50%">


<div id="org0d751a9" class="figure">
<p><img src="./fig/objectives.png" alt="Objectives" width="100%" />
</p>
</div>

</div>

</section>
</section>
<section>
<section id="slide-org51953cf">
<h2 id="org51953cf">Introduction</h2>

<div id="orgc43b4d7" class="figure">
<p><img src="./fig/machine_learning.png" alt="Inférence" width="70%" />
</p>
</div>


</section>
</section>
<section>
<section id="slide-org5adaa92">
<h3 id="org5adaa92">Problématique</h3>
<div class="block-definition" id="orga3e685c">
<p>
<h4>Objectif</h4>
</p>

<ul>
<li>Modéliser un phénomène aléatoire impliquant différentes variables \(X_{1}, \ldots, X_{D}\)</li>
<li>Utiliser un réseau bayésien afin de représenter au mieux les relations entre les variables</li>

</ul>

</div>

<div class="block-definition" id="org1c7e3cc">
<p>
<h4>Problèmes</h4>
</p>

<ul>
<li>Comment déterminer la structure du réseau bayésien (i.e. le graphe) ?</li>
<li>Comment estimer les lois de probabilité conditionnelles (LPC) ?</li>

</ul>

</div>

<div class="block-example" id="org0da6fdf">
<p>
<h4>Approches envisageables</h4>
</p>

<ul>
<li>Approche par expertise : utilisation d'avis d'experts et connaissances métiers</li>
<li>Approche statistique : utilisation de bases de données (contenant éventuellement des
informations incomplètes)</li>
<li>Approche mixte : expertise + bases de données</li>

</ul>

</div>

</section>
<section id="slide-org20ef5ed">
<h4 id="org20ef5ed">Problématique</h4>
<p>
<div class="slidesubtitle">Exemple : Vente d'un livret</div>
</p>


<div id="org8953a6b" class="figure">
<p><img src="./fig/rb_vente_var.png" alt="RB vente" width="95%" />
</p>
</div>

</section>
<section id="slide-org7e3d5c1">
<h4 id="org7e3d5c1">Problématique</h4>
<p>
<div class="slidesubtitle">Apprentissage de la structure</div>
</p>


<div id="org7a12b87" class="figure">
<p><img src="./fig/rb_vente_graphe_app.png" alt="RB vente" width="95%" />
</p>
</div>


</section>
<section id="slide-org99b7158">
<h4 id="org99b7158">Problématique</h4>
<p>
<div class="slidesubtitle">Apprentissage des LPC (structure fixée)</div>
</p>


<div id="org2b1c881" class="figure">
<p><img src="./fig/rb_vente_lpc_app.png" alt="RB vente" width="95%" />
</p>
</div>


</section>
<section id="slide-orgc6381cc">
<h4 id="orgc6381cc">Problématique</h4>
<p>
<div class="slidesubtitle">Apprentissage complet du réseau bayésien</div>
</p>


<div id="org538777d" class="figure">
<p><img src="./fig/rb_vente_graphe_lpc_app.png" alt="RB vente" width="95%" />
</p>
</div>


</section>
</section>
<section>
<section id="slide-org7426e92">
<h3 id="org7426e92">Construction par expertise</h3>
<p>
<div class="slidesubtitle">Acquisition de l'information</div>
</p>

<div class="block-definition" id="org216d71e">
<p>
<h4>Acquisition de l'information</h4>
</p>

<ul>
<li>Trouver des personnes expertes fiables et coopératives</li>
<li>Familiariser ces personnes à la notion de probabilité</li>
<li>Tenir compte de leurs biais éventuels (souvent inconscients)</li>
<li>Utiliser un outil pour faciliter le recueil des informations</li>
<li>Exemple : échelle de probabilité :</li>

</ul>


<div id="org14e87cd" class="figure">
<p><img src="https://roland-donat.github.io/cours-rb/stid_intro/fig/echelle_prob.png" alt="Echelle prob" width="90%" />
</p>
</div>

<p>
 <br>
</p>

</div>



</section>
<section id="slide-orgaf81928">
<h4 id="orgaf81928">Construction par expertise</h4>
<p>
<div class="slidesubtitle">Attention au connexions convergentes (V-structures)</div>
</p>

<div class="block-alert" id="orgc4a640e">
<p>
<h4>Problème</h4>
</p>

<ul>
<li>L'expertise métier permet en général de construire des RB fidèles à la réalité opérationnelle</li>
<li>En revanche, l'humain a intuitivement tendance à introduire des connexions convergentes
<ul>
<li>Exemple : Soit \(Y\) un phénomène à expliquer et \(X_{1}, \ldots, X_{D}\), \(D\) facteurs explicatifs possibles</li>
<li>Structure naturelle : \(X_{1} \to Y, \ldots, X_{D} \to Y\)</li>
<li>Risque d'explosion combinatoire : Définir \(P(Y|X_{1},\ldots,X_{D})\) nécessite \(2^{D}\) valeurs
dans le cas où les variables sont binaires</li>

</ul></li>

</ul>

</div>

<div class="fragment (appear) block-example" id="orge76f8bc">
<p>
<h4>Solutions possibles</h4>
</p>

<ul>
<li>Inverser les flèches et utiliser une structure naïve : \(Y \to X_{1}, \ldots, Y \to X_{D}\) en
assumant les simplifications induites</li>
<li>Introduction d'un modèle de LPC particulier, e.g. modèle OU-bruité</li>

</ul>

</div>


</section>
</section>
<section>
<section id="slide-org4365343">
<h2 id="org4365343">Apprentissage des LPC</h2>

<div id="org1b079b3" class="figure">
<p><img src="./fig/learning_data_complete.png" alt="Inférence" width="60%" />
</p>
</div>

</section>
</section>
<section>
<section id="slide-orgd28e97f">
<h3 id="orgd28e97f">Apprentissage des LPC - Données complètes</h3>
<p>
<div class="slidesubtitle">Hypothèses</div>
</p>

<div class="block-definition" id="org85ac8fa">
<p>
<h4>Hypothèses</h4>
</p>
<ul>
<li>On modélise un phénomène aléatoire caractérisé par des variables aléatoires \(X_{1}, \ldots, X_{D}\)
dont la loi est représentée par un RB</li>
<li>Les variables aléatoires \(X_{1}, \ldots, X_{D}\) sont discrètes et finies</li>
<li>Le graphe du RB est supposé connu</li>
<li>On dispose d'un jeu de données \(\boldsymbol{D}\) contenant \(N\) observations indépendantes des
variables aléatoires \(X_{1}, \ldots, X_{D}\)</li>

</ul>

</div>

<div class="block-definition" id="org83a6cc5">
<p>
<h4>Objectif</h4>
</p>

<p>
On cherche à estimer les LPC de ce RB :
</p>
<ul>
<li>\(\Prob\lrPar{X_{1}|\pa\lrPar{X_{1}}}\)</li>
<li>\(\Prob\lrPar{X_{2}|\pa\lrPar{X_{2}}}\)</li>
<li>\(\ldots\)</li>
<li>\(\Prob\lrPar{X_{d}|\pa\lrPar{X_{d}}}\)</li>
<li>\(\ldots\)</li>
<li>\(\Prob\lrPar{X_{D}|\pa\lrPar{X_{D}}}\)</li>

</ul>
<p>
où \(\pa\lrPar{X_{d}}\) désigne les variables parentes de la variable \(X_{d}\) dans le graphe du RB
</p>

</div>


</section>
</section>
<section>
<section id="slide-org0fa4163">
<h3 id="org0fa4163">Apprentissage des LPC - Données complètes</h3>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org57a662f" class="figure">
<p><img src="./fig/rb_vente_lpc_app_mod.png" alt="LPC app" width="100%" />
</p>
</div>

</section>
<section id="slide-orgd7548ca">
<h4 id="orgd7548ca">Apprentissage des LPC - Données complètes</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orgb243bcc" class="figure">
<p><img src="./fig/rb_vente_lpc_app_ex1.png" alt="LPC app" width="100%" />
</p>
</div>

</section>
<section id="slide-org81c11e3">
<h4 id="org81c11e3">Apprentissage des LPC - Données complètes</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orga91d90c" class="figure">
<p><img src="./fig/rb_vente_lpc_app_ex2.png" alt="LPC app" width="100%" />
</p>
</div>

</section>
<section id="slide-org2faa2e3">
<h4 id="org2faa2e3">Apprentissage des LPC - Données complètes</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orgaa9469e" class="figure">
<p><img src="./fig/rb_vente_lpc_app_ex3.png" alt="LPC app" width="100%" />
</p>
</div>

</section>
<section id="slide-org77f3657">
<h4 id="org77f3657">Apprentissage des LPC - Données complètes</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org1d202c8" class="figure">
<p><img src="./fig/rb_vente_lpc_app_ex4.png" alt="LPC app" width="100%" />
</p>
</div>

</section>
<section id="slide-org339ca66">
<h4 id="org339ca66">Apprentissage des LPC - Données complètes</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orga3b501d" class="figure">
<p><img src="./fig/rb_vente_lpc_app_ex5.png" alt="LPC app" width="100%" />
</p>
</div>

</section>
<section id="slide-org7dd076b">
<h4 id="org7dd076b">Apprentissage des LPC - Données complètes</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orge13a918" class="figure">
<p><img src="./fig/rb_vente_lpc_app_ex6.png" alt="LPC app" width="100%" />
</p>
</div>

</section>
<section id="slide-org5469655">
<h4 id="org5469655">Apprentissage des LPC - Données complètes</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org06f0579" class="figure">
<p><img src="./fig/rb_vente_lpc_app_ex7.png" alt="LPC app" width="100%" />
</p>
</div>

</section>
<section id="slide-org54c0418">
<h4 id="org54c0418">Apprentissage des LPC - Données complètes</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org54b9dee" class="figure">
<p><img src="./fig/rb_vente_lpc_app_ex8.png" alt="LPC app" width="100%" />
</p>
</div>



</section>
</section>
<section>
<section id="slide-org3c91e0e">
<h3 id="org3c91e0e">Apprentissage des LPC - Données complètes</h3>
<p>
<div class="slidesubtitle">Estimation des LPC</div>
</p>

<div class="block-definition" id="org3352b84">
<p>
<h4>Estimation des LPC</h4>
</p>

<ul>
<li>L'estimation de chaque LPC d'un RB a pour expression :
\[
  \hat{P}(X_{d} = x_{d,k}|\text{pa}(X_{d}) = \boldsymbol{x}^{\prime}_{d,j}) =
  \frac{\# \{X_{d} = x_{d,k}~ \text{et}~
      \text{pa}(X_{d}) = \boldsymbol{x}^{\prime}_{d,j}\}}{\# \{\text{pa}(X_{d}) = \boldsymbol{x}^{\prime}_{d,j}\}}
  \]
<ul>
<li>\(x_{d,k}\) : \(k\) -ème valeur possible pour la v.a. \(X_{d}\)</li>
<li>\(\boldsymbol{x}^{\prime}_{d,j}\) : \(j\) -ème configuration de valeurs possibles pour les parents de la
v.a. \(X_{d}\)</li>

</ul></li>

<li><b>Interprétation</b> : Chaque probabilité \(\hat{P}(X_{d} = x_{d,k}|\text{pa}(X_{d}) =
    \boldsymbol{x}^{\prime}_{d,j})\) est estimée par le rapport entre : 
<ul>
<li>le nombre d'événements \(\{X_{d} = x_{d,k}~ \text{et}~
      \text{pa}(X_{d}) = \boldsymbol{x}^{\prime}_{d,j}\}\) observés dans les données</li>
<li>et le nombre d'événements \(\{\text{pa}(X_{d}) = \boldsymbol{x}^{\prime}_{d,j}\}\) observés dans les données</li>

</ul></li>

</ul>

</div>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
controlsLayout: 'edges', slideNumber:"c/t", center: false, transition: 'fade',

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]

});

</script>
</body>
</html>
