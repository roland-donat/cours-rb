<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<title>Modélisation stochastique et approche bayésienne  <br> <br> <br> <font size="10">Inférence probabiliste</font></title>
<meta name="author" content="Roland Donat"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/theme/white.css" id="theme"/>

<link rel="stylesheet" href="https://roland-donat.github.io/ubs/Charte_graphique/ensibs/ensibs_reveal.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
TeX: {
Macros: {
pa: ["\\text{pa}"],
Pa: ["\\text{Pa}"],
lrpar: ["\\left( #1 \\right)", 1],
lrPar: ["\\left( #1 \\right)", 1],
set: ["\\left\\lbrace #1 \\right\\rbrace", 1],
Prob: ["P"],
inter: ["\\cap"],
union: ["\\cup"],
Dom: ["\\text{Dom}"],
mbf: ["\\boldsymbol{#1}", 1],
mathbfcal: ["\\boldsymbol{\\mathcal{#1}}", 1],
sm: ["\\setminus"],
}
}
});
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-background="https://roland-donat.github.io/ubs/Charte_graphique/ensibs/ensibs-ppt-couv.jpg"><h1 class="title">Modélisation stochastique et approche bayésienne  <br> <br> <br> <font size="10">Inférence probabiliste</font></h1><p class="subtitle"></p>
<h2 class="author">Roland Donat</h2><h2 class="date"> <br>Spécialité Cyber Data</h2>
</section>
<section id="sec-table-of-contents"><div id="table-of-contents" role="doc-toc">
<h2>Table des matières</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#/slide-org655df0f">Objectifs de la séance</a></li>
<li><a href="#/slide-org4c99ce4">Introduction à l'inférence probabiliste</a></li>
<li><a href="#/slide-org1549c36">Notion de potentiel</a></li>
<li><a href="#/slide-org334619c">Complexité</a></li>
<li><a href="#/slide-org496f7c9">Méthode d'élimination des variables</a></li>
<li><a href="#/slide-orgbeb8495">Résumé de la séance</a></li>
<li><a href="#/slide-orge4105b6">Bibliographie</a></li>
<li><a href="#/slide-orgd6e21a8">Algorithme d'élimination</a></li>
</ul>
</div>
</div>
</section>


<section>
<section id="slide-org655df0f">
<h2 id="org655df0f">Objectifs de la séance</h2>
<div class="column" style="float:left; width: 50%">

<ul>
<li>Comprendre la notion d'inférence probabiliste dans un réseau bayésien</li>
<li>Maîtriser les calculs effectués par un algorithme d'inférence exacte</li>
<li>Introduire la notion de complexité dans le cadre des réseaux bayésiens</li>
<li>Prendre conscience des avantages et des limites de l'inférence dans les réseaux bayésiens</li>

</ul>

</div>

<div class="column" style="float:right; width: 50%">


<div id="org6a36416" class="figure">
<p><img src="./fig/objectives.png" alt="Objectives" width="100%" />
</p>
</div>

</div>

</section>
</section>
<section>
<section id="slide-org4c99ce4">
<h2 id="org4c99ce4">Introduction à l'inférence probabiliste</h2>

<div id="org4ba72d2" class="figure">
<p><img src="./fig/inference.png" alt="Inférence" width="70%" />
</p>
</div>

</section>
</section>
<section>
<section id="slide-org8726252">
<h3 id="org8726252">Introduction à l'inférence probabiliste</h3>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orgd3932a2" class="figure">
<p><img src="./fig/rb_inference_alarme_pb.png" alt="Inférence problématique" width="95%" />
</p>
</div>

</section>
<section id="slide-org61a4026">
<h4 id="org61a4026">Introduction à l'inférence probabiliste</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orge850361" class="figure">
<p><img src="./fig/rb_inference_alarme_ex_1.png" alt="Inférence problématique" width="95%" />
</p>
</div>

</section>
<section id="slide-org4c2c8b8">
<h4 id="org4c2c8b8">Introduction à l'inférence probabiliste</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org8190ae0" class="figure">
<p><img src="./fig/rb_inference_alarme_ex_2.png" alt="Inférence problématique" width="95%" />
</p>
</div>

</section>
</section>
<section>
<section id="slide-orgdd0a67f">
<h3 id="orgdd0a67f">Introduction à l'inférence probabiliste</h3>
<p>
<div class="slidesubtitle">Formalisation</div>
</p>

<div class="block-definition" id="org5c62bc6">
<p>
<h4>Définition</h4>
</p>

<ul>
<li>Soit un RB représentant la loi jointe d'une suite de v.a. \(\boldsymbol{X} = \lrpar{X_{1}, \ldots, X_{n}}\) à valeurs dans
\(\mathcal{X}_{1}, \ldots, \mathcal{X}_{n}\) respectivement</li>
<li><b>Objectif</b> : calculer les lois de la forme
\[
  \Prob\lrPar{\boldsymbol{Q}|\boldsymbol{E} = \boldsymbol{e}}
  \]</li>
<li>\(\boldsymbol{Q} = \lrpar{Q_{1},\ldots,Q_{\ell}} \subseteq \boldsymbol{X}\) est une suite de
v.a. appelée "requête" de l'inférence</li>
<li>\(\boldsymbol{E} = \lrpar{E_{1},\ldots,E_{m}} \subseteq \boldsymbol{X}\) est une suite de v.a.,
observées aux valeurs \(\boldsymbol{e} = \lrpar{e_{1},\ldots, e_{m}}\), appelée "évidence" de l'inférence</li>
<li>Contrainte : \(\boldsymbol{Q} \inter \boldsymbol{E} = \varnothing\)</li>

</ul>

</div>

</section>
</section>
<section>
<section id="slide-org6f3f0e2">
<h3 id="org6f3f0e2">Introduction à l'inférence probabiliste</h3>
<p>
<div class="slidesubtitle">Algorithmes d'inférence</div>
</p>

<div class="block-definition" id="org12894db">
<p>
<h4>Inférence exacte</h4>
</p>
<ul>
<li>Algorithme <i>belief propagation</i> (Pearl, J., 1988) adapté aux structures
d'arbres (ou polyarbres)</li>
<li>Méthodes reposant sur la construction de l'arbre de jonction (Lauritzen, S. L. and Spiegelhalter, D. J., 1988)</li>
<li><b>Méthodes d'élimination des variables</b> (Cozman, Fabio G., 2000,  Dechter, R., 1999)</li>

</ul>

</div>

<div class="block-definition" id="org5f3ef51">
<p>
<h4>Inférence approchée déterministe</h4>
</p>
<ul>
<li>Algorithme <i>loopy belief propagation</i> (Murphy, K. P. and Weiss, Y. and Jordan, M. I., 1999) : Utilisation de la méthode
<i>belief propagation</i> sur un graphe général</li>
<li>Méthode de raisonnement par pertinence (Lin, Yan and Druzdzel, Marek J., 1999)</li>

</ul>

</div>

<div class="block-definition" id="org3564e73">
<p>
<h4>Inférence approchée stochastique</h4>
</p>
<ul>
<li>Méthode d'échantillonnage type Monte-Carlo</li>

</ul>

</div>


</section>
</section>
<section>
<section id="slide-org1549c36">
<h2 id="org1549c36">Notion de potentiel</h2>

<div id="org4007147" class="figure">
<p><img src="./fig/potential.png" alt="Inférence" width="70%" />
</p>
</div>

</section>
</section>
<section>
<section id="slide-org5704fb8">
<h3 id="org5704fb8">Notion de potentiel</h3>
<p>
<div class="slidesubtitle">Exemple</div>
</p>

<div class="column" style="float:left; width: 33%">


<div id="org297caed" class="figure">
<p><img src="./fig/dfpot_3_var.png" alt="dfpot 3 var" height="100%" />
</p>
</div>

</div>

<div class="column" style="float:right; width: 66%">

<div class="block-definition" id="orgb08ddcf">
<p>
<h4>Caractéristiques d'un potentiel</h4>
</p>
<ul>
<li>\(\Dom\lrPar{\Phi} = \set{\mathcal{X},\mathcal{Y},\mathcal{Z}}\) avec :
<ul>
<li>\(\mathcal{X} = \set{x_{1},x_{2}}\)</li>
<li>\(\mathcal{Y} = \set{y_{1},y_{2},y_{3}}\)</li>
<li>\(\mathcal{Z} = \set{z_{1},z_{2}}\)</li>

</ul></li>
<li>Configurations de \(\Phi\) : \(\Dom\lrPar{\Phi}^{*} = \set{x_{1},x_{2}} \times
  \set{y_{1},y_{2},y_{3}} \times \set{z_{1},z_{2}}\)</li>
<li>\(\Phi\) possède \(|\Dom\lrPar{\Phi}^{*}| = |\mathcal{X}| \times |\mathcal{Y}| \times |\mathcal{Z}| = 2 \times 3 \times 2 = 12\) configurations</li>
<li>Pour toute configuration \((x,y,z) \in \mathcal{X} \times \mathcal{Y} \times \mathcal{Z}\), \(\Phi\) prend la valeur \(\Phi\lrPar{x,y,z}\)</li>

</ul>

</div>


</div>


</section>
</section>
<section>
<section id="slide-orgffcb23a">
<h3 id="orgffcb23a">Notion de potentiel</h3>
<p>
<div class="slidesubtitle">Définition</div>
</p>

<div class="block-definition" id="orgc50b858">
<p>
<h4>Concept général</h4>
</p>
<ul>
<li>Un potentiel est une application de plusieurs variables à valeurs dans un ensemble quelconque et
muni d'opérations particulières</li>
<li>L'ensemble des potentiels est muni d'opérations particulières</li>
<li>Les potentiels définis dans ce cours sont des cas particuliers de tenseurs</li>

</ul>

</div>

<div class="block-definition" id="org75ddadf">
<p>
<h4>Potentiel discret et fini réel</h4>
</p>
<ul>
<li><p>
Soit \(\mathcal{X}_{1}, \ldots, \mathcal{X}_{D}\) une famille d'ensembles discrets et finis. \(\Phi\)
est un potentiel réel sur le domaine \(\set{\mathcal{X}_{1}, \ldots, \mathcal{X}_{D}}\) si 
\(\Phi\) est une application définie par
</p>
<div>
\begin{equation*}
\Phi : 
\left\lbrace
  \begin{array}{ccc}
    \mathcal{X}_{1} \times \ldots \times \mathcal{X}_{D}
    & \mapsto & \mathbb{R} \\
    \lrPar{x_{1}, \ldots, x_{D}} & \mapsto & \Phi\lrPar{x_{1},\ldots,x_{D}} 
  \end{array}
\right..
\end{equation*}

</div></li>

</ul>

</div>

<div class="block-definition" id="org5e86c36">
<p>
<h4>Vocabulaire et notations</h4>
</p>
<ul>
<li>Le domaine du potentiel \(\Phi\) est noté \(\Dom\lrPar{\Phi} = \set{\mathcal{X}_{1}, \ldots, \mathcal{X}_{D}}\)</li>
<li>\(\Dom\lrPar{\Phi}^{*} = \prod_{d = 1}^{D} \mathcal{X}_{d} = \mathcal{X}_{1} \times \ldots \times
  \mathcal{X}_{D}\)  (produit cartésien des ensembles \(\mathcal{X}_{d}\))</li>
<li>Tout élément \(\lrpar{x_{1},\ldots,x_{D}} \in \Dom\lrPar{\Phi}^{*}\) est appelé configuration</li>
<li>Si \(|\Dom\lrpar{\Phi}| = D\), on dit que \(\Phi\) est un potentiel à \(D\) dimensions</li>

</ul>

</div>


</section>
</section>
<section>
<section id="slide-org3da0d50">
<h3 id="org3da0d50">Notion de potentiel</h3>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="orgf6ea45a" class="figure">
<p><img src="./fig/dfpot_prod_2_var_0.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org0297fce">
<h4 id="org0297fce">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="org130f083" class="figure">
<p><img src="./fig/dfpot_prod_2_var_0_bis.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org617084c">
<h4 id="org617084c">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="org78a967a" class="figure">
<p><img src="./fig/dfpot_prod_2_var_1.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org3e1d878">
<h4 id="org3e1d878">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="orgd2dc5eb" class="figure">
<p><img src="./fig/dfpot_prod_2_var_2.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-orgbec10db">
<h4 id="orgbec10db">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="orgdb8860c" class="figure">
<p><img src="./fig/dfpot_prod_2_var_3.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org6ea5de8">
<h4 id="org6ea5de8">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="orgadcd216" class="figure">
<p><img src="./fig/dfpot_prod_2_var_4.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org145f7ec">
<h4 id="org145f7ec">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="orgd7c65a8" class="figure">
<p><img src="./fig/dfpot_prod_2_var_5.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org4f73e75">
<h4 id="org4f73e75">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="org759e05b" class="figure">
<p><img src="./fig/dfpot_prod_2_var_6.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org948293a">
<h4 id="org948293a">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="org5a38c1b" class="figure">
<p><img src="./fig/dfpot_prod_2_var_7.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org9effbfd">
<h4 id="org9effbfd">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="org4007f84" class="figure">
<p><img src="./fig/dfpot_prod_2_var_8.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org03275ec">
<h4 id="org03275ec">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Exemple</div>
</p>


<div id="org5389a72" class="figure">
<p><img src="./fig/dfpot_prod_2_var.png" alt="dfpot prod" width="85%" />
</p>
</div>

</section>
<section id="slide-org2e4f39b">
<h4 id="org2e4f39b">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Produit de deux potentiels - Définition</div>
</p>

<div class="block-definition" id="orge47c76a">
<p>
<h4>Produit de deux potentiels discrets et finis</h4>
</p>
<ul>
<li>Soient deux potentiels réels discrets et finis \(\Phi_{1}\) et \(\Phi_{2}\)</li>
<li>Notons :
<ul>
<li>\(\mathbfcal{X} = \Dom\lrPar{\Phi_{1}} \setminus \Dom\lrPar{\Phi_{2}}\)</li>
<li>\(\mathbfcal{Y} = \Dom\lrPar{\Phi_{2}} \setminus \Dom\lrPar{\Phi_{1}}\)</li>
<li>\(\mathbfcal{Z} = \Dom\lrPar{\Phi_{1}} \inter \Dom\lrPar{\Phi_{2}}\)</li>

</ul></li>
<li><p>
Le produit de \(\Phi_{1}\) et \(\Phi_{2}\) est un potentiel \(\Psi = \Phi_{1} \cdot \Phi_{2}\) de domaine \(\Dom\lrPar{\Psi} = \Dom\lrPar{\Phi_{1}} \union \Dom\lrPar{\Phi_{2}}\) vérifiant pour toute
configuration \((\mbf{x},\mbf{z},\mbf{y}) \in \mathbfcal{X}^{*} \times \mathbfcal{Z}^{*} \times
  \mathbfcal{Y}^{*}\) : 
</p>
<div>
\begin{equation*}
  \Psi\lrpar{\mbf{x},\mbf{z},\mbf{y}} =
  \Phi_{1}\lrpar{\mbf{x},\mbf{z}} \cdot \Phi_{2}\lrpar{\mbf{z},\mbf{y}}
\end{equation*}

</div></li>

</ul>

</div>


</section>
</section>
<section>
<section id="slide-org082e913">
<h3 id="org082e913">Notion de potentiel</h3>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Exemple</div>
</p>


<div id="org6202490" class="figure">
<p><img src="./fig/dfpot_marg_3_var_0.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-org57990a6">
<h4 id="org57990a6">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Exemple</div>
</p>


<div id="org1d4ac64" class="figure">
<p><img src="./fig/dfpot_marg_3_var_0_bis.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-org9aceca1">
<h4 id="org9aceca1">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Exemple</div>
</p>


<div id="org0609e05" class="figure">
<p><img src="./fig/dfpot_marg_3_var_0_ter.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-orgf56f163">
<h4 id="orgf56f163">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Exemple</div>
</p>


<div id="org141870b" class="figure">
<p><img src="./fig/dfpot_marg_3_var_0_ter2.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-orgdcb8c79">
<h4 id="orgdcb8c79">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Exemple</div>
</p>


<div id="orgfb87966" class="figure">
<p><img src="./fig/dfpot_marg_3_var_1.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-org99f612c">
<h4 id="org99f612c">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Exemple</div>
</p>


<div id="org7a6c650" class="figure">
<p><img src="./fig/dfpot_marg_3_var_2.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-org12bb751">
<h4 id="org12bb751">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Exemple</div>
</p>


<div id="orgcc2d35e" class="figure">
<p><img src="./fig/dfpot_marg_3_var_3.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-orga2d91dd">
<h4 id="orga2d91dd">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Exemple</div>
</p>


<div id="org0807fab" class="figure">
<p><img src="./fig/dfpot_marg_3_var_4.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-org846a9bc">
<h4 id="org846a9bc">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Exemple</div>
</p>


<div id="orga95cb1e" class="figure">
<p><img src="./fig/dfpot_marg_3_var.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-org49a93e6">
<h4 id="org49a93e6">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Sommation/Marginalisation - Définition</div>
</p>

<div class="block-definition" id="orgfedf804">
<p>
<h4>Sommation/Marginalisation d'un potentiel discret et fini</h4>
</p>
<ul>
<li>Soit un potentiel réel discret et fini \(\Phi\)</li>
<li><p>
Le résultat de la sommation de \(\Phi\) sur le domaine \(\mathbfcal{W}\) est un potentiel \(\Psi = \sum_{\mathbfcal{W}} \Phi\) de domaine \(\Dom\lrPar{\Psi} = \Dom\lrPar{\Phi} \sm \mathbfcal{W}\) vérifiant pour toute configuration \(\mbf{x} \in \Dom\lrPar{\Psi}^{*}\):
</p>
<div>
\begin{equation*}
  \Psi\lrpar{\mbf{x}} = \sum_{\mbf{w} \in \mathbfcal{W}} \Phi\lrpar{\mbf{x},\mbf{w}}
\end{equation*}

</div></li>
<li>Cette opération est également appelée marginalisation du potentiel \(\Phi\) sur le domaine \(\Dom\lrPar{\Phi} \sm \mathbfcal{W}\)</li>

</ul>

</div>


</section>
</section>
<section>
<section id="slide-org615b7c5">
<h3 id="org615b7c5">Notion de potentiel</h3>
<p>
<div class="slidesubtitle">Instanciation - Exemple</div>
</p>


<div id="org05db1fd" class="figure">
<p><img src="./fig/dfpot_inst_3_var_0.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-orgcd72701">
<h4 id="orgcd72701">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Instanciation - Exemple</div>
</p>


<div id="org3e2f7a7" class="figure">
<p><img src="./fig/dfpot_inst_3_var_1.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-org8876145">
<h4 id="org8876145">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Instanciation - Exemple</div>
</p>


<div id="org47a70b6" class="figure">
<p><img src="./fig/dfpot_inst_3_var_2.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-org93c2690">
<h4 id="org93c2690">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Instanciation - Exemple</div>
</p>


<div id="org548a880" class="figure">
<p><img src="./fig/dfpot_inst_3_var_3.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-orgac3cc6a">
<h4 id="orgac3cc6a">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Instanciation - Exemple</div>
</p>


<div id="org0010969" class="figure">
<p><img src="./fig/dfpot_inst_3_var.png" alt="dfpot sum" width="85%" />
</p>
</div>

</section>
<section id="slide-org27a1853">
<h4 id="org27a1853">Notion de potentiel</h4>
<p>
<div class="slidesubtitle">Instanciation - Définition</div>
</p>

<div class="block-definition" id="orgfab22f3">
<p>
<h4>Instanciation d'un potentiel discret et fini</h4>
</p>
<ul>
<li>Soit un potentiel réel discret et fini \(\Phi\)</li>
<li>L'instanciation de \(\Phi\) sur la configuration \(\mbf{y} \in \mathbfcal{Y} \subseteq
  \Dom\lrPar{\Phi}\) est la projection du potentiel \(\Phi\) sur le domaine \(\Dom\lrPar{\Phi_{\mbf{y}}}
  = \lrPar{\Dom\lrPar{\Phi} \sm \mathbfcal{Y}} \union \mbf{y}\)</li>
<li>\(\Phi\) instancié sur \(\mbf{y}\) est un potentiel défini sur toutes les configurations \(\mbf{x} \in
  \lrPar{\Dom\lrPar{\Phi} \sm \mathbfcal{Y}}^{*}\) tel que \(\Phi\lrpar{\mbf{x},\mbf{y}}\)</li>

</ul>

</div>

</section>
</section>
<section>
<section id="slide-org9a79dd5">
<h3 id="org9a79dd5">Les LPC : des potentiels particuliers</h3>
<p>
<div class="slidesubtitle">Exemple</div>
</p>

<div class="column" style="float:left; width: 40%">


<div id="org016bcd4" class="figure">
<p><img src="./fig/dfcpd_3_var.png" alt="dfcpd 3 var" height="100%" />
</p>
</div>

</div>

<div class="column" style="float:right; width: 55%">

<div class="block-example" id="orgec859de">
<p>
<h4>Retour sur la LPC de la variable Alarme</h4>
</p>
<ul>
<li>Variable normalisée : 
<ul>
<li>Alarme : à valeurs dans \(\set{\text{non},\text{oui}}\)</li>

</ul></li>
<li>Variables de conditionnement :
<ul>
<li>Voleur : à valeurs dans \(\set{\text{non},\text{oui}}\)</li>
<li>Orage : à valeurs dans \(\set{\text{non}, \text{faible},\text{fort}}\)</li>

</ul></li>

</ul>

</div>

</div>

</section>
<section id="slide-orgc9788c2">
<h4 id="orgc9788c2">Les LPC : des potentiels particuliers</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>

<div class="column" style="float:left; width: 40%">


<div id="orgaad0095" class="figure">
<p><img src="./fig/dfcpd_3_var_pot_2.png" alt="dfcpd 3 var" height="100%" />
</p>
</div>

</div>

<div class="column" style="float:right; width: 55%">

<div class="block-example" id="org52bccf9">
<p>
<h4>Retour sur la LPC de la variable Alarme</h4>
</p>
<ul>
<li>Variable normalisée : 
<ul>
<li>Alarme : à valeurs dans \(\set{\text{non},\text{oui}}\)</li>

</ul></li>
<li>Variables de conditionnement :
<ul>
<li>Voleur : à valeurs dans \(\set{\text{non},\text{oui}}\)</li>
<li>Orage : à valeurs dans \(\set{\text{non}, \text{faible},\text{fort}}\)</li>

</ul></li>

</ul>

</div>

</div>

</section>
<section id="slide-orgb7587af">
<h4 id="orgb7587af">Les LPC : des potentiels particuliers</h4>
<p>
<div class="slidesubtitle">Définition</div>
</p>

<div class="block-definition" id="org0c3b8af">
<p>
<h4>Potentiel et LPC</h4>
</p>
<ul>
<li>Soit un potentiel réel discret et fini à valeur dans \([0,1]\) noté \(p\)</li>
<li><p>
S'il existe deux sous-domaines disjoints \(\mathbfcal{X}\) et \(\mathbfcal{Y}\) avec \(\Dom\lrPar{p} =
  \mathbfcal{X} \union \mathbfcal{Y}\) tels que pour toute configuration \(\mbf{y} \in \mathbfcal{Y}^{*}\)
</p>
<div>
\begin{equation*}
\sum_{\mbf{x} \in \mathbfcal{X}^{*}} p\lrpar{\mbf{x},\mbf{y}} = 1.
\end{equation*}

</div></li>
<li>Le potentiel \(p\) est une Loi de Probabilité Conditionnelle (LPC) sur \(\mathbfcal{X}\)
conditionnellement à \(\mathbfcal{Y}\)</li>

</ul>

</div>

<div class="block-definition" id="org4304c2a">
<p>
<h4>Vocabulaire</h4>
</p>
<ul>
<li>Le domaine \(\mathbfcal{Y}\) est appelé domaine de conditionnement</li>
<li>Le domaine \(\mathbfcal{X}\) est appelé domaine normalisé</li>

</ul>

</div>


</section>
</section>
<section>
<section id="slide-org334619c">
<h2 id="org334619c">Complexité</h2>

<div id="orgc4db80a" class="figure">
<p><img src="./fig/complexity.png" alt="Complexité" width="70%" />
</p>
</div>


</section>
</section>
<section>
<section id="slide-orgbf5e219">
<h3 id="orgbf5e219">Complexité d'un potentiel</h3>
<div class="block-definition" id="org916c9a6">
<p>
<h4>Complexité spatiale</h4>
</p>
<ul>
<li>Soit un potentiel réel discret et fini \(\Phi\) tel que \(\Dom\lrPar{\Phi} = \set{\mathcal{X}_{1},
  \ldots, \mathcal{X}_{D}}\)</li>
<li>La complexité spatiale de \(\Phi\), notée \(\text{CS}\lrpar{\Phi}\), correspond au nombre de
configurations du domaine de \(\Phi\) :
\[
  \text{CS}\lrpar{\Phi} = |\Dom\lrpar{\Phi}^{*}|
  \]</li>

</ul>

</div>

<div class="block-definition" id="orgcc8348d">
<p>
<h4>Conséquence</h4>
</p>
<ul>
<li>\(\text{CS}\lrpar{\Phi} \simeq v^{D}\) quand \(v\) et/ou \(D\) sont grands avec :
<ul>
<li>\(D\) : nombre de variables représenté dans le domaine du potentiel</li>
<li>\(v = \max \set{|\mathcal{X}_{1}|, \ldots, |\mathcal{X}_{D}|}\) : Plus grand nombre de valeurs
prises par une v.a.</li>

</ul></li>

</ul>

</div>

<div class="block-definition" id="orgb427b17">
<p>
<h4>Complexité algorithmique</h4>
</p>

<ul>
<li>Soient deux potentiels réels discrets et finis \(\Phi_{1}\) et \(\Phi_{2}\), et \(\mathcal{T}\) un
traitement à réaliser</li>
<li>On note \(\text{CA}(\mathcal{T})\), la complexité algorithmique du traitement \(\mathcal{T}\)</li>
<li>\(\text{CA}\lrpar{\Phi_{1} \cdot \Phi_{2}} \simeq \text{CS}\lrpar{\Phi_{1} \cdot \Phi_{2}}
  = |\lrpar{\Dom\lrpar{\Phi_{1}} \union \Dom\lrpar{\Phi_{2}}}^{*}|\)</li>
<li>\(\text{CA}\lrpar{\sum_{\mathbfcal{W}}\Phi_{1}} \simeq
  \text{CS}\lrpar{\sum_{\mathbfcal{W}}\Phi_{1}} = |\lrpar{\Dom\lrpar{\Phi_{1}} \sm
  \mathbfcal{W}}^{*}|\)</li>
<li>Les complexités algorithmiques et spatiales sont du même ordre</li>

</ul>

</div>


</section>
</section>
<section>
<section id="slide-orgf64afa0">
<h3 id="orgf64afa0">Complexité d'une LPC</h3>
<p>
<div class="slidesubtitle">Complexité spatiale</div>
</p>

<div class="block-definition" id="org68d8eb5">
<p>
<h4>Complexité spatiale d'une LPC discrète et finie</h4>
</p>

<ul>
<li>Soient \(\boldsymbol{X} = X_{1},\ldots,X_{n}\) et \(\boldsymbol{Y} = Y_{1},\ldots,Y_{m}\) deux suites de
v.a. à valeurs dans les ensembles discrets et finis \(\mathcal{X}_{1}, \ldots,
  \mathcal{X}_{n}\) et \(\mathcal{Y}_{1}, \ldots, \mathcal{Y}_{m}\)</li>

<li>La complexité spatiale associée à la LPC \(P(X_{1},\ldots,X_{n}|Y_{1},\ldots,Y_{m}) = P(\boldsymbol{X}|\boldsymbol{Y})\),
notée \(CS(P(\boldsymbol{X}|\boldsymbol{Y}))\), est définie par le <b>nombre de configurations de
valeurs différentes que peuvent prendre les v.a. \(X_{1},\ldots,X_{n}, Y_{1}, \ldots, Y_{m}\)</b></li>

<li>Autrement dit : 
\[
  CS(P(\boldsymbol{X}|\boldsymbol{Y})) = \prod_{i = 1}^{n} |\mathcal{X}_{i}| \prod_{j =
  1}^{m} |\mathcal{Y}_{j}|
  \]
où \(|\mathcal{X}_{i}|\) est le nombre d'éléments dans l'ensemble \(\mathcal{X}_{i}\)</li>

</ul>

</div>

</section>
<section id="slide-org5143724">
<h4 id="org5143724">Complexité d'une LPC</h4>
<p>
<div class="slidesubtitle">Complexité spatiale</div>
</p>


<div id="orgbdb50c0" class="figure">
<p><img src="./fig/rb_definition_alarme.png" alt="RB alarme definition" width="80%" />
</p>
</div>

<div class="block-example" id="org5a98145">
<p>
<h4>Exercice</h4>
</p>
<ul>
<li>Donner les complexités spatiales des LPC du RB "Alarme"</li>

</ul>

</div>

</section>
<section id="slide-orgd0296d5">
<h4 id="orgd0296d5">Complexité d'une LPC</h4>
<p>
<div class="slidesubtitle">Complexité probabiliste</div>
</p>

<div class="block-definition" id="org4b14600">
<p>
<h4>Complexité probabiliste d'une LPC discrète et finie</h4>
</p>

<ul>
<li>Soient \(\boldsymbol{X} = X_{1},\ldots,X_{n}\) et \(\boldsymbol{Y} = Y_{1},\ldots,Y_{m}\) deux suites de
v.a. à valeurs dans les ensembles discrets et finis \(\mathcal{X}_{1}, \ldots,
  \mathcal{X}_{n}\) et \(\mathcal{Y}_{1}, \ldots, \mathcal{Y}_{m}\)</li>

<li>La complexité probabiliste associée à la LPC \(P(X_{1},\ldots,X_{n}|Y_{1},\ldots,Y_{m}) = P(\boldsymbol{X}|\boldsymbol{Y})\),
notée \(CP(P(\boldsymbol{X}|\boldsymbol{Y}))\), est définie par le <b>nombre de paramètres
(probabilités) nécessaires pour définir la LPC</b></li>

<li>Autrement dit : 
\[
  CP(P(\boldsymbol{X}|\boldsymbol{Y})) = \prod_{i = 1}^{n} (|\mathcal{X}_{i}| - 1) \prod_{j =
  1}^{m} |\mathcal{Y}_{j}|
  \]</li>

<li>La CP tient simplement compte du fait qu'une LPC doit sommer à 1 pour chaque configuration des
variables de conditionnement</li>
<li>La CP mesure le potentiel de modélisation d'une loi (notion de degré de liberté)</li>

</ul>

</div>

<div class="block-example" id="org1961e16">
<p>
<h4>Exercice</h4>
</p>

<ul>
<li>Donner les complexités probabilistes des LPC du RB "Alarme"</li>

</ul>

</div>


</section>
</section>
<section>
<section id="slide-orgf3e6d73">
<h3 id="orgf3e6d73">Complexité d'un réseau bayésien</h3>
<p>
<div class="slidesubtitle">Définition</div>
</p>

<div class="block-definition" id="org33326a2">
<p>
<h4>Complexité d'une loi jointe représentée par un RB</h4>
</p>

<ul>
<li>Soit \(X_{1},\ldots,X_{n}\) une suite de v.a. à valeurs dans les ensembles discrets et finis
\(\mathcal{X}_{1}, \ldots, \mathcal{X}_{n}\)</li>
<li>La complexité spatiale (resp. probabiliste) d'une loi jointe factorisée dans un RB est définie
comme étant la somme des complexités spatiales (resp. probabilistes) associées à chacune des LPC
\(P(X_{i}|\text{pa}(X_{i}))\)</li>

<li>La <b>complexité spatiale</b> du RB a pour expression :
\[
  CS(RB) = \sum_{i = 1}^{n}
  CS(P(X_{i}|\text{pa}(X_{i}))) = \sum_{i = 1}^{n} |\mathcal{X}_{i}| \times
  \prod_{\mathcal{X} \in \text{pa}(\mathcal{X}_{i})} |\mathcal{X}|
  \]</li>
<li>La <b>complexité probabiliste</b> a pour expression :
\[
  CP(RB) = \sum_{i = 1}^{n}
  CP(P(X_{i}|\text{pa}(X_{i}))) = \sum_{i = 1}^{n} (|\mathcal{X}_{i}| - 1) \times
  \prod_{\mathcal{X} \in \text{pa}(\mathcal{X}_{i})} |\mathcal{X}|
  \]</li>

</ul>

</div>

</section>
<section id="slide-org11048c0">
<h4 id="org11048c0">Complexité d'un réseau bayésien</h4>
<p>
<div class="slidesubtitle">Conséquences pratiques</div>
</p>

<div class="block-definition" id="org7e34f3b">
<p>
<h4>RB = Représentation parcimonieuse</h4>
</p>

<ul>
<li><b>Un RB est une représentation compacte d'un processus aléatoire</b></li>

<li>Moins il y a d'arcs dans le graphe :
<ul>
<li>Plus des hypothèses d'indépendances conditionnelles entre les variables sont posées</li>
<li>Plus le potentiel de modélisation, i.e. la capacité à représenter des phénomènes complexes, diminue (\(CP\) faible)</li>
<li>Plus la représentation par RB est avantageuse du point de vue du stockage, du paramétrage et de la complexité calculatoire (\(CS\) faible)</li>

</ul></li>

</ul>

</div>

<div class="block-example" id="org8d7e8d7">
<p>
<h4>Exercice</h4>
</p>

<p>
Calculer les complexités du modèle "Alarme" avec et sans RB
</p>

</div>


</section>
</section>
<section>
<section id="slide-org496f7c9">
<h2 id="org496f7c9">Méthode d'élimination des variables</h2>

<div id="org0a89cba" class="figure">
<p><img src="./fig/bucket_elimination.png" alt="Bucket elimination" width="70%" />
</p>
</div>


</section>
</section>
<section>
<section id="slide-orgf8581d4">
<h3 id="orgf8581d4">Méthode d'élimination des variables</h3>
<p>
<div class="slidesubtitle">Généralités</div>
</p>

<div class="block-definition" id="org2a7bb49">
<p>
<h4>Hypothèses d'utilisation</h4>
</p>

<ul>
<li>Méthode adaptée pour les réseaux bayésiens à <b>variables discrètes et finies</b>,
i.e. les LPC sont des potentiels discrets et finis</li>
<li>Si le phénomène étudié implique des variables continues et/ou non finies, il faut les <b>discrétiser</b>
au préalable</li>

</ul>

</div>

<div class="block-definition" id="orgbc905c4">
<p>
<h4>Principe</h4>
</p>

<ul>
<li>"Éliminer" par sommations successives toutes les variables de la loi jointe qui
n'apparaissent pas dans le calcul à réaliser</li>
<li>Simplifier le calcul à réaliser grâce à la propriété de factorisation des RB et choississant un
"bon" ordre d'élimination des variables</li>
<li>Algorithme de référence implémenté dans la plupart des outils de réseaux bayésiens</li>

</ul>

</div>

</section>
</section>
<section>
<section id="slide-org11ecce4">
<h3 id="org11ecce4">Méthode d'élimination des variables</h3>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org82cda33" class="figure">
<p><img src="./fig/rb_alarme_graphe.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="org7e1ef18">
<p>
<h4>Inférence dans le réseau bayésien Alarme</h4>
</p>

<ul>
<li>La problématique fait intervenir 4 variables aléatoires : Voleur (\(V\)), Alarme (\(A\)), Orage (\(O\)),
Info météo (\(M\))</li>
<li>Le RB qui modélise la problématique permet de factoriser la loi jointe des variables aléatoire comme suit :
\[  
  P(V,A,O,M) = P(V) \times P(A|V, O) \times P(O) \times P(M|O)
  \]</li>

</ul>

</div>

</section>
<section id="slide-orgb781b25">
<h4 id="orgb781b25">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>

<div class="block-example" id="org846bb73">
<p>
<h4>Calcul de P(Voleur=oui|Alarme=oui)</h4>
</p>
<ul>
<li>Par définition : \(\displaystyle P(V = \text{oui}|A = \text{oui}) = \frac{P(V = \text{oui}; A = \text{oui})}{P(A = \text{oui})}\)</li>

</ul>

</div>

<div class="block-example" id="orgdf020da">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li>On instancie les variables de conditionnement à leur valeur demandée, ici \(A = \text{oui}\)</li>
<li>Puis, on somme (élimine) les variables différentes de Voleur et Alarme :
\[
  P(V; A = \text{oui}) = \sum_{O \in \{\text{non},
  \text{faible},\text{fort}\}} \sum_{M \in \{\text{non}, \text{oui}\}} P(V; A = \text{oui}; O;M) 
  \]</li>
<li>Pour simplifier les calculs, on utilisera la propriété de factorisation de la loi jointe dans le RB</li>

</ul>

</div>

<div class="block-example" id="org2426f65">
<p>
<h4>Calcul du dénominateur</h4>
</p>

<ul>
<li>On utilise le calcul du numérateur en marginalisant sur la variable Alarme :
\[
  P(A = \text{oui}) = \sum_{V \in \set{\text{non}; \text{oui}}} P(V; A = \text{oui}) 
  \]</li>

</ul>

</div>


</section>
<section id="slide-org8cb8e4e">
<h4 id="org8cb8e4e">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orgff6ffaf" class="figure">
<p><img src="./fig/rb_alarme.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="orga820f33">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li><p>
On cherche à calculer :
</p>
<div>
\begin{equation*}
P(V ; A) = \sum_{O \in \{\text{non}, \text{faible},\text{fort}\}} \sum_{M \in \{\text{non},
\text{oui}\}} P(V ; A ; O ; M)
\end{equation*}

</div></li>

</ul>

</div>

</section>
<section id="slide-org53025c6">
<h4 id="org53025c6">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org9265a12" class="figure">
<p><img src="./fig/rb_alarme.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="org0eb3fea">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li><p>
D'après la propriété de factorisation de la jointe dans le RB :
</p>
<div>
\begin{equation*}
P(V ; A) = \sum_{O \in \{\text{non}, \text{faible},\text{fort}\}} \sum_{M \in \{\text{non},
\text{oui}\}} P(V) \cdot P(A | V ; O) \cdot P(O) \cdot P(M|O)
\end{equation*}

</div></li>

</ul>

</div>


</section>
<section id="slide-org7399855">
<h4 id="org7399855">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org8fa75c2" class="figure">
<p><img src="./fig/rb_alarme_inf_inst.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="org6520b0a">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li><p>
On instancie les variables de conditionnement, ici \(A = \text{oui}\) :
</p>
<div>
\begin{equation*}
P(V ; A = \text{oui}) = \sum_{O \in \{\text{non}, \text{faible},\text{fort}\}} \sum_{M \in \{\text{non}, 
\text{oui}\}} P(V) \cdot P(A = \text{oui} | V ; O) \cdot P(O) \cdot P(M|O)
\end{equation*}

</div></li>

</ul>

</div>

</section>
<section id="slide-orgd62f8f1">
<h4 id="orgd62f8f1">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org55236c4" class="figure">
<p><img src="./fig/rb_alarme_inf_inst.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="org66524f9">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li><p>
On "élimine" successivement les variables \(M\) et \(O\) en distibuant les sommes dans la
factorisation : 
</p>
<div>
\begin{equation*}
P(V ; A = \text{oui}) = P(V) \cdot \sum_{O \in \{\text{non}, \text{faible},\text{fort}\}} P(A = \text{oui} | V ; O) \cdot P(O) \cdot \sum_{M \in \{\text{non}, 
\text{oui}\}} P(M|O)
\end{equation*}

</div></li>

</ul>

</div>

</section>
<section id="slide-orgad37599">
<h4 id="orgad37599">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org61fe798" class="figure">
<p><img src="./fig/rb_alarme_inf_sum_M.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="org5ef0ad5">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li><p>
Sommation sur \(M\) :
factorisation : 
</p>
<div>
\begin{equation*}
P(V ; A = \text{oui}) = P(V) \cdot \sum_{O \in \{\text{non}, \text{faible},\text{fort}\}} P(A = \text{oui} | V ; O) \cdot P(O) \cdot \underbrace{\sum_{M \in \{\text{non}, \text{oui}\}} P(M|O)}_{\text{potentiel composé de 1}}
\end{equation*}

</div></li>
<li>Le potentiel obtenu ne contient que des 1, on peut donc le supprimer du produit</li>

</ul>

</div>





</section>
<section id="slide-org2287156">
<h4 id="org2287156">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org077bb29" class="figure">
<p><img src="./fig/rb_alarme_inf_sum_O_prod_1.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="orga832c78">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li><p>
On fait le produit des potentiels/LPC qui dépendent de \(O\) :
factorisation : 
</p>
<div>
\begin{equation*}
P(V ; A = \text{oui}) = P(V) \cdot \sum_{O \in \{\text{non}, \text{faible},\text{fort}\}} \underbrace{P(A = \text{oui} | V ; O) \cdot P(O)}_{\Psi_{O}(A = \text{oui} ; V ; O)}
\end{equation*}

</div></li>

</ul>

</div>





</section>
<section id="slide-orgdae46c6">
<h4 id="orgdae46c6">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orgb42b101" class="figure">
<p><img src="./fig/rb_alarme_inf_sum_O_prod_2.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="org1b2e783">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li><p>
On fait le produit des potentiels/LPC qui dépendent de \(O\) :
factorisation : 
</p>
<div>
\begin{equation*}
P(V ; A = \text{oui}) = P(V) \cdot \sum_{O \in \{\text{non}, \text{faible},\text{fort}\}} \Psi_{O}(A = \text{oui} ; V ; O)
\end{equation*}

</div></li>

</ul>

</div>


</section>
<section id="slide-orge888ecf">
<h4 id="orge888ecf">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org3fd06ef" class="figure">
<p><img src="./fig/rb_alarme_inf_sum_O.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="orgf517929">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li><p>
Puis on somme sur \(O\) pour "éliminer" cette variable :
factorisation : 
</p>
<div>
\begin{equation*}
P(V ; A = \text{oui}) = P(V) \cdot \underbrace{\sum_{O \in \{\text{non}, \text{faible},\text{fort}\}} \Psi_{O}(A = \text{oui} ; V ; O)}_{\Phi_{O}(A = \text{oui} ; V)}
\end{equation*}

</div></li>

</ul>

</div>


</section>
<section id="slide-orgdd7a7b0">
<h4 id="orgdd7a7b0">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="org59a72dc" class="figure">
<p><img src="./fig/rb_alarme_inf_prod_end_1.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="orgbb11921">
<p>
<h4>Calcul du numérateur</h4>
</p>
<ul>
<li><p>
Il ne reste plus qu'à faire un dernier produit pour obtenir le numérateur
</p>
<div>
\begin{equation*}
P(V ; A = \text{oui}) = P(V) \cdot \Phi_{O}(A = \text{oui} ; V)
\end{equation*}

</div></li>

</ul>

</div>

</section>
<section id="slide-org8f7ec9f">
<h4 id="org8f7ec9f">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Exemple</div>
</p>


<div id="orgddbe829" class="figure">
<p><img src="./fig/rb_alarme_inf_prod_end_2.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="orgf41b54c">
<p>
<h4>Calcul final</h4>
</p>
<ul>
<li>Numérateur : \(P(V = \text{oui}; A = \text{oui}) = 0.000999\)</li>
<li>Dénominateur : \(P(A = \text{oui}) = P(V = \text{oui}; A = \text{oui}) + P(V = \text{non}; A =
  \text{oui}) = 0.002346651\)</li>
<li>On en déduit : \(P(V = \text{oui}|A = \text{oui}) = \frac{0.000999}{0.002346651} = 0.4257130694\)</li>

</ul>

</div>


</section>
</section>
<section>
<section id="slide-orgd903356">
<h3 id="orgd903356">Méthode d'élimination des variables</h3>
<p>
<div class="slidesubtitle">Formalisation</div>
</p>

<div class="block-definition" id="org2cefb7c">
<p>
<h4>Rappel de l'objectif</h4>
</p>

<ul>
<li>Soit \(\mbf{X} = \lrpar{X_{1}, \ldots, X_{n}}\) une suite de v.a.</li>
<li>Calculer \(\Prob\lrPar{\mbf{Q}|\mbf{E} = \mbf{e}}\) avec \(\mbf{Q} \subseteq \mbf{X}\), \(\mbf{E}
  \subseteq \mbf{X}\) et \(\mbf{Q} \inter \mbf{E} = \varnothing\)</li>

</ul>

</div>

<div class="block-definition" id="org2e4ddce">
<p>
<h4>Principe</h4>
</p>
<ul>
<li>Par définition : \(\displaystyle \Prob\lrPar{\mbf{Q}|\mbf{E} = \mbf{e}} =
  \frac{\Prob\lrPar{\mbf{Q}, \mbf{E} = \mbf{e}}}{\Prob\lrPar{\mbf{E} = \mbf{e}}}\)</li>
<li>En posant \(\mbf{W} = \mbf{X} \sm (\mbf{Q},\mbf{E})\), on a
\[
  \Prob\lrPar{\mbf{Q}, \mbf{E} = \mbf{e}} = \sum_{W \in \mbf{W}}
  \underbrace{\Prob\lrPar{X_{1},\ldots,X_{n}}}_{\text{loi jointe de la suite $\mbf{X}$}} = \sum_{W
  \in \mbf{W}} \Prob\lrPar{\mbf{Q},\mbf{W},\mbf{E} = \mbf{e}}
  \]</li>
<li><b>Principe :</b> Simplifier le calcul de \(\Prob\lrPar{\mbf{Q}|\mbf{E} = \mbf{e}}\) grâce à la propriété
de factorisation dans un RB</li>
<li><b>En pratique :</b> Toutes les variables hors requête et évidence sont "éliminées" de l'expression de
la loi jointe par sommation</li>

</ul>

</div>

</section>
</section>
<section>
<section id="slide-org3e81863">
<h3 id="org3e81863">Méthode d'élimination des variables</h3>
<p>
<div class="slidesubtitle">Complexité</div>
</p>

<div class="block-definition" id="org15df557">
<p>
<h4>Complexité de l'algorithme</h4>
</p>
<ul>
<li>On note \(\sigma : \{1, \ldots, D\} \mapsto \{1, \ldots, D\}\) l'ordre des variables à éliminer</li>
<li>Pire cas : \((n - 1)\) variables à éliminer</li>
<li>Opérations coûteuses : calcul des potentiels \(\Phi_{\sigma(i)}\) et \(\Psi_{\sigma(i)}\)</li>
<li><p>
Complexité de l'algorithme :
</p>
<div>
\begin{align*}
\text{CA}\lrPar{\text{AEV}} & \simeq \sum_{i} \text{CS}\lrPar{\Phi_{\sigma(i)}} +
\text{CS}\lrPar{\Psi_{\sigma(i)}} \\ & \simeq n v_{\star}^{D_{\star}}
\end{align*}

</div>
<ul>
<li>\(D_{\star}\) : Nombre de dimensions du plus gros potentiel \(\Phi_{\sigma(i)}\), noté \(\Phi_{\star}\)</li>
<li>\(v_{\star}\) : Nombre de valeurs dans la plus grande dimension de \(\Phi_{\star}\)</li>

</ul></li>
<li>Risque d'explosion exponentielle</li>

</ul>

</div>

<div class="block-alert" id="org5293be6">
<p>
<h4>Inférence exacte dans un RB</h4>
</p>
<ul>
<li>Il n'existe pas d'algorithme polynomial d'inférence exacte pour un RB quelconque</li>
<li>Le calcul de probabilité dans un RB est un problème NP-difficile</li>

</ul>

</div>

</section>
</section>
<section>
<section id="slide-org411d629">
<h3 id="org411d629">Méthode d'élimination des variables</h3>
<p>
<div class="slidesubtitle">Remarques sur l'ordre d'élimination</div>
</p>

<div class="block-definition" id="orgd65a7cc">
<p>
<h4>Propriétés</h4>
</p>

<ul>
<li>L'ordre d'élimination des variables n'influe pas sur le résultat, i.e. tous les ordres aboutissent au même (bon) résultat</li>
<li>En revanche, la rapidité des calculs est fortement liée à l'ordre d'élimination</li>

</ul>

</div>

<div class="block-alert" id="org2ebb2f4">
<p>
<h4>Problématique</h4>
</p>
<ul>
<li>Trouver un "bon" ordre consiste à rechercher un ordre qui limite la taille des \(\Phi_{\sigma(i)}\) à chaque élimination</li>
<li>Malheureusement :
<ul>
<li>Trouver l'ordre optimal est un problème NP-complet</li>
<li>Même l'ordre optimal peut dans certains cas aboutir à une explosion combinatoire</li>

</ul></li>
<li>En pratique, on utilise des heuristiques ou des connaissances sur le graphe pour déterminer
l'ordre d'élimination</li>

</ul>

</div>

</section>
<section id="slide-org8087d5e">
<h4 id="org8087d5e">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Stratégies pour déterminer l'ordre d'élimination</div>
</p>

<div class="block-definition" id="orgd139f25">
<p>
<h4>Stratégie 1 : Application d'une heuristique</h4>
</p>
<ul>
<li>Utilisation d'un algorithme glouton muni d'une fonction de coût donnée</li>
<li>À chaque étape, on élimine la variable qui minimise le coût</li>
<li>Exemples de fonctions de coût :
<ul>
<li>Nombre de voisins de la v.a. courante</li>
<li>Complexité de \(\Phi_{\sigma(i)}\) engendré par l'élimination de la v.a. courante</li>

</ul></li>

</ul>

</div>

<div class="block-definition" id="org6c9a4af">
<p>
<h4>Stratégie 2 : Exploiter sa connaissance du graphe</h4>
</p>
<ul>
<li>Exemples de cas où cela peut être profitable :
<ul>
<li>Graphes avec peu de variables mais avec des LPC de tailles très hétérogènes car cette situation
peut piéger les méthodes gloutonnes</li>
<li>Graphes très grands mais très structurés (e.g. modèle bayésien naïf)</li>

</ul></li>

</ul>

</div>

</section>
<section id="slide-org9c19d46">
<h4 id="org9c19d46">Méthode d'élimination des variables</h4>
<p>
<div class="slidesubtitle">Illustration de l'influence de l'ordre d'élimination</div>
</p>


<div id="org82f28d5" class="figure">
<p><img src="./fig/rb_bayes_naif.png" alt="RB alarme definition" width="55%" />
</p>
</div>

<div class="block-example" id="org2d34d6f">
<p>
<h4>Quel ordre choisir ?</h4>
</p>
<ul>
<li>Objectif : Calculer \(\Prob\lrPar{{\color{EMLogoOrange}X_{i}}}\)</li>
<li>Option 1 : Élimination des \(X_{j}\), \(j \neq i\) et enfin élimination de \(Y\) ?</li>
<li>Option 2 : Élimination de \(Y\), puis élimination des \(X_{j}\), \(j \neq i\) ?</li>

</ul>

</div>





</section>
</section>
<section>
<section id="slide-orgbeb8495">
<h2 id="orgbeb8495">Résumé de la séance</h2>
<div class="block-definition" id="orga0b7e41">
<p>
<h4>Points clés sur l'inférence</h4>
</p>

<ul>
<li>Inférence dans un RB : Calculer des probabilités</li>
<li>Inférence exacte : Problème NP-Difficile</li>
<li>L'inférence dans RB discret et fini repose sur des sommes et des produits de potentiels</li>

</ul>

</div>

<div class="block-definition" id="orga44d66e">
<p>
<h4>Points clés sur l'algorithme d'élimination</h4>
</p>
<ul>
<li>Méthode d'inférence exacte</li>
<li>Méthode simple et intuitive ne reposant pas sur la théorie des graphes</li>
<li>Principe :
<ul>
<li>Réduction de la loi jointe en propageant les évidences (ce que l'on sait)</li>
<li>Élimination des variables hors requête et évidence par sommations successives</li>
<li>Multiplication des potentiels restants à la fin de la procédure</li>
<li>Normalisation du potentiel résultant afin d'obtenir la LPC recherchée</li>

</ul></li>
<li>Complexité de l'algorithme fortement dépendante de l'ordre d'élimination des variables</li>

</ul>

</div>

</section>
</section>
<section>
<section id="slide-orgc9cfb9a">
<h3 id="orgc9cfb9a">Merci pour votre attention !</h3>
<p>
<div class="slidesubtitle">Des questions ?</div>
</p>



<div id="orgaf6b0ab" class="figure">
<p><img src="https://roland-donat.github.io/cours-rb/commons/questions.png" alt="FAQ" width="60%" />
</p>
</div>


</section>
</section>
<section>
<section id="slide-orge4105b6">
<h2 id="orge4105b6">Bibliographie</h2>
<p>
Cozman, Fabio G. (2000). <i>Generalizing {Variable} {Elimination} in {Bayesian} {Networks}</i>, Editora Tec Art.</p>

<p>
Dechter, R. (1999). <i>Bucket {Elimination}: {A} {Unifying} {Framework} for {Reasoning}</i>, Artificial Intelligence.</p>

<p>
Lauritzen, S. L. and Spiegelhalter, D. J. (1988). <i>Local {Computations} with {Probabilities} on {Graphical} {Structures} and {Their} {Application} to {Expert} {Systems}</i>, Journal of the Royal Statistical Society.</p>

<p>
Lin, Yan and Druzdzel, Marek J. (1999). <i>Relevance-based {Incremental} {Belief} {Updating} in {Bayesian} {Networks}</i>, International Journal of Pattern Recognition and Artificial Intelligence.</p>

<p>
Murphy, K. P. and Weiss, Y. and Jordan, M. I. (1999). <i>Loopy {Belief} {Propagation} for {Approximate} {Inference}: {An} {Empirical} {Study}</i>.</p>

<p>
Pearl, J. (1988). <i>Probabilistic {Reasoning} in {Intelligent} {Systems}: {Networks} of {Plausible} {Inference}</i>, Morgan Kaufmann.</p>

</section>
</section>
<section>
<section id="slide-orgd6e21a8">
<h2 id="orgd6e21a8">Algorithme d'élimination</h2>
<ul>
<li><b>Entrées</b> :
<ul>
<li>LPC \(\set{\Prob\lrPar{X_{i}|\pa\lrpar{X_{i}}}}_{1\le i \le n}\) de la loi jointe factorisée des v.a. \(\mbf{X} = \lrpar{X_{1},\ldots,X_{n}}\)</li>
<li>Une suite de v.a. de requête \(\mbf{Q} \subseteq \mbf{X}\)</li>
<li>Une suite de v.a. \(\mbf{E} \subseteq \mbf{X}\), \(\mbf{Q} \inter \mbf{E} = \varnothing\)</li>
<li>Une permutation \(\sigma\) des v.a. \(\lrpar{X_{1},\ldots,X_{n}}\) représentant l'ordre d'élimination des v.a}</li>

</ul></li>
<li><b>Sortie</b> : La loi \(\Prob\lrpar{\mbf{Q}|\mbf{E}}\)</li>

<li><b>Initialisation</b> : Liste des potentiels à considérer \(\mathcal{P} \gets
  \set{\Prob\lrPar{X_{1}|\pa\lrpar{X_{1}}}, \ldots, \Prob\lrPar{X_{n}|\pa\lrpar{X_{n}}}}\)</li>

<li><b>Pour tout</b> \(i = 1, \ldots, n\) (Itération sur l'ordre d'élimination)
<ul>
<li><b>Si</b> \(X_{\sigma(i)} \in \mbf{W} = \mbf{X} \sm (\mbf{Q}, \mbf{E})\) (Vérification si la variable courante est à éliminer)
<ul>
<li>\(\mathcal{B}_{\sigma(i)} \gets \set{\psi \in \mathcal{P} | X_a{\sigma(i)} \in
      \Dom\lrPar{\psi}}\) (Potentiels cibles dont le domaine contient la v.a. à éliminée)</li>
<li>\(\mathcal{P} \gets \mathcal{P} \sm \mathcal{B}_{\sigma(d)}\) (Suppression des potentiels cibles de la liste de potentiels courante)</li>
<li>\(\Phi_{\sigma(i)} \gets \prod_{\psi \in \mathcal{B}_{\sigma(i)}} \psi\) (Produit des potentiels
cibles)</li>
<li>\(\Psi_{\sigma(i)} \gets \sum_{X_{\sigma(i)}} \Phi_{\sigma(i)}\) (Élimination de la variable)</li>
<li>\(\mathcal{P} \gets \mathcal{P} \union \set{\Psi_{\sigma(i)}}\) (Mise à jour de la liste des potentiels)</li>

</ul></li>

</ul></li>
<li>\(\Prob\lrpar{\mbf{Q},\mbf{E}} \gets \prod_{\psi \in \mathcal{P}} \psi\)</li>
<li>Déduction de \(\Prob\lrpar{\mbf{Q}|\mbf{E}}\) en normalisant \(\Prob\lrpar{\mbf{Q}|\mbf{E}}\) sur la suite de v.a. \(\mbf{Q}\)</li>

</ul>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
controlsLayout: 'edges', slideNumber:"c/t", center: false, transition: 'fade',

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]

});

</script>
</body>
</html>
